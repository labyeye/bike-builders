<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>Updates | Bike Builders</title>
    <link rel="stylesheet" href="./globals.css" />
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./updates.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    
    <style>
      /* Loading and error states */
      .loading-spinner {
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top: 4px solid #4CAF50;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 2rem auto;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .error-message, .no-offers {
        color: white;
        text-align: center;
        padding: 2rem;
        background: rgba(255, 0, 0, 0.2);
        border-radius: 8px;
        width: 100%;
      }
      
      .no-offers {
        background: rgba(255, 255, 255, 0.1);
      }
      
      /* Offer type indicators */
      .offer-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: bold;
        text-transform: uppercase;
      }
      
      .offer-type-new { background: #00BCD4; color: white; }
      .offer-type-sale { background: #2196F3; color: white; }
      .offer-type-event { background: #9C27B0; color: white; }
      .offer-type-festival { background: #FF5722; color: white; }
    </style>
  </head>
  <body>
    <div class="hero-section updates-hero">
      <div class="overlay">
        <div class="rectangle"></div>
        <div class="gradient"></div>
      </div>

      <nav class="navbar">
        <a href="index.html" class="logo-link">
          <div class="logo">
            <img src="./assets/logo2.svg" class="logo-img" alt="Bike Builders Logo" itemprop="logo" />
          </div>
        </a>
        <ul class="nav-links">
          <li><a href="index.html" data-translate="Home">Home</a></li>
          <li><a href="inventory.html" data-translate="Buy Bike">Buy Bike</a></li>
          <li><a href="sell.html" data-translate="Sell Your Bike">Sell Your Bike</a></li>
          <li><a href="about.html" aria-label="About Bike Builders" data-translate="About Us">About Us</a></li>
          <li><a href="book.html" aria-label="Book Bike" data-translate="Book Bike">Book Bike</a></li>
          <li><a href="./updates.html" data-translate="Updates" class="active">Updates</a></li>
          <li><a href="contact.html" data-translate="Contact">Contact</a></li>
        </ul>
        <div class="login-btn">
          <a href="/getquote.html">
            <button data-translate="Get the Quote">Get the Quote</button>
          </a>
        </div>
      </nav>
      
      <section class="updates-section">
        <div class="updates-content">
          <h2 data-translate="Latest Updates">Latest Updates</h2>
          <p data-translate="Stay informed with the latest news, offers, and announcements from Bike Builders.">
            Stay informed with the latest news, offers, and announcements from Bike Builders.
          </p>
        </div>

        <div class="updates-container" id="updates-container">
          <div class="loading-spinner"></div>
        </div>
      </section>
    </div>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <div class="logo">
            <img src="./assets/logo2.svg" style="width: 50px" alt="Bike Builders Logo" />
          </div>
          <p data-translate="Bringing the future of bike riding to you today.">
            Bringing the future of bike riding to you today.
          </p>
          <div class="social-icons">
            <a href="https://www.facebook.com/share/1Ao18FYX8e/">
              <i class="fa-brands fa-facebook-f" style="color: #0400ff"></i>
            </a>
            <a href="https://www.instagram.com/bikebuilders41?igsh=ZDk5M3NxdmI1Ymhp" aria-label="Visit our Instagram profile">
              <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" style="width: 20px" />
            </a>
            <a href="https://wa.me/918210283582">
              <i class="fa-brands fa-whatsapp" style="color: #00a841"></i>
            </a>
          </div>
        </div>
        <div class="footer-section">
          <h3 data-translate="Quick Links">Quick Links</h3>
          <ul>
            <li><a href="index.html" data-translate="Home">Home</a></li>
            <li><a href="inventory.html" data-translate="Buy Bike">Buy Bike</a></li>
            <li><a href="sell.html" data-translate="Sell Your Bike">Sell Your Bike</a></li>
            <li><a href="about.html" aria-label="About Bike Builders" data-translate="About Us">About Us</a></li>
            <li><a href="book.html" aria-label="Book Bike" data-translate="Book Bike">Book Bike</a></li>
            <li><a href="./updates.html" data-translate="Updates" class="active">Updates</a></li>
            <li><a href="contact.html" data-translate="Contact">Contact</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3 data-translate="Contact Us">Contact Us</h3>
          <p data-translate="Rambag Chowk, Rambag Road Kabristaan k bagal me, Gaushala Chowk Mandir , Muzaffarpur, Bihar 842002">
            <i class="fas fa-map-marker-alt"></i> Rambag Chowk, Rambag Road Kabristaan k bagal me, Gaushala Chowk Mandir , Muzaffarpur, Bihar 842002
          </p>
          <span itemprop="telephone">+91 8210283582 / 7564987167 / 9825944897</span>
        </div>
      </div>
      <div class="footer-bottom">
        <p data-translate="&copy; 2023 Bike Builders. All rights reserved.">
          &copy; 2023 Bike Builders. All rights reserved.
        </p>
        <a href="www.pixelatenest.com" style="color: #a9a9a9" data-translate="Designed By Pixelate Nest">
          Designed By Pixelate Nest
        </a>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Translation functionality
        const translations = {
          en: {
            "Latest Updates": "Latest Updates",
            "Stay informed with the latest news, offers, and announcements from Bike Builders.": 
              "Stay informed with the latest news, offers, and announcements from Bike Builders.",
            "View Offer": "View Offer",
            "Learn More": "Learn More",
            "New": "New",
            "Sale": "Sale",
            "Event": "Event",
            "Festival": "Festival",
            "No current offers available. Check back later!": "No current offers available. Check back later!",
            "Failed to load updates. Please try again later.": "Failed to load updates. Please try again later."
          },
          hi: {
            "Latest Updates": "नवीनतम अपडेट",
            "Stay informed with the latest news, offers, and announcements from Bike Builders.": 
              "Bike Builders के नवीनतम समाचार, ऑफ़र और घोषणाओं के बारे में जानकारी रखें।",
            "View Offer": "ऑफ़र देखें",
            "Learn More": "और जानें",
            "New": "नया",
            "Sale": "बिक्री",
            "Event": "कार्यक्रम",
            "Festival": "त्योहार",
            "No current offers available. Check back later!": "कोई वर्तमान ऑफर उपलब्ध नहीं है। बाद में पुनः जांचें!",
            "Failed to load updates. Please try again later.": "अपडेट लोड करने में विफल। कृपया बाद में पुनः प्रयास करें।"
          }
        };

        const preferredLanguage = localStorage.getItem("preferredLanguage") || "en";

        function translateText() {
          if (preferredLanguage !== "en") {
            document.body.classList.add("hindi-font");
            const elements = document.querySelectorAll("[data-translate]");
            elements.forEach((element) => {
              const key = element.getAttribute("data-translate");
              if (translations[preferredLanguage] && translations[preferredLanguage][key]) {
                element.textContent = translations[preferredLanguage][key];
              }
            });
          }
        }

        translateText();

        // Fetch offers from backend
        fetch('https://bike-builders.onrender.com/api/offers')
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(offers => {
            const container = document.getElementById('updates-container');
            container.innerHTML = '';
            
            if (offers.error) {
              container.innerHTML = `
                <p class="error-message" data-translate="Failed to load updates. Please try again later.">
                  ${translations[preferredLanguage]["Failed to load updates. Please try again later."]}
                </p>
              `;
              return;
            }

            if (offers.length === 0) {
              container.innerHTML = `
                <p class="no-offers" data-translate="No current offers available. Check back later!">
                  ${translations[preferredLanguage]["No current offers available. Check back later!"]}
                </p>
              `;
              return;
            }

            offers.forEach((offer, index) => {
              const offerDate = new Date(offer.startDate).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              });
              
              const offerCard = document.createElement('div');
              offerCard.className = 'update-card';
              offerCard.dataset.type = offer.type;
              offerCard.style.animationDelay = `${index * 0.1}s`;
              
              const typeTranslation = translations[preferredLanguage][offer.type.charAt(0).toUpperCase() + offer.type.slice(1)] || offer.type;
              
              offerCard.innerHTML = `
                <span class="offer-badge offer-type-${offer.type}">${typeTranslation}</span>
                <div class="update-date">${offerDate}</div>
                <h3 class="update-title">${offer.title}</h3>
                <p class="update-description">${offer.description}</p>
                <a href="${offer.link || '#'}" class="update-link">
                  ${offer.cta || translations[preferredLanguage]["Learn More"]}
                </a>
              `;
              
              container.appendChild(offerCard);
            });
          })
          .catch(error => {
            console.error('Error fetching offers:', error);
            const container = document.getElementById('updates-container');
            container.innerHTML = `
              <p class="error-message" data-translate="Failed to load updates. Please try again later.">
                ${translations[preferredLanguage]["Failed to load updates. Please try again later."]}
              </p>
            `;
          });
      });
    </script>
     <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get modal elements
        const whatsappModal = document.getElementById("whatsappModal");
        const callModal = document.getElementById("callModal");

        // Get trigger buttons
        const whatsappTrigger = document.getElementById("whatsappTrigger");
        const callTrigger = document.getElementById("callTrigger");

        // Get close buttons
        const closeButtons = document.getElementsByClassName("close");

        // When user clicks WhatsApp button
        whatsappTrigger.addEventListener("click", function (e) {
          e.preventDefault();
          whatsappModal.style.display = "block";
        });

        // When user clicks Call button
        callTrigger.addEventListener("click", function (e) {
          e.preventDefault();
          callModal.style.display = "block";
        });

        // When user clicks on close button
        Array.from(closeButtons).forEach((button) => {
          button.addEventListener("click", function () {
            whatsappModal.style.display = "none";
            callModal.style.display = "none";
          });
        });

        // When user clicks outside the modal
        window.addEventListener("click", function (event) {
          if (event.target == whatsappModal) {
            whatsappModal.style.display = "none";
          }
          if (event.target == callModal) {
            callModal.style.display = "none";
          }
        });

        // Handle number selection for WhatsApp
        const whatsappOptions =
          whatsappModal.querySelectorAll(".number-option");
        whatsappOptions.forEach((option) => {
          option.addEventListener("click", function () {
            const number = this.getAttribute("data-number");
            window.open(`https://wa.me/${number}`, "_blank");
            whatsappModal.style.display = "none";
          });
        });

        // Handle number selection for Call
        const callOptions = callModal.querySelectorAll(".number-option");
        callOptions.forEach((option) => {
          option.addEventListener("click", function () {
            const number = this.getAttribute("data-number");
            window.location.href = `tel:${number}`;
            callModal.style.display = "none";
          });
        });
      });
    </script>

    <div class="floating-buttons">
      
      <a
        href="#"
        class="floating-btn whatsapp-btn"
        data-tooltip="Chat on WhatsApp"
        aria-label="Chat on WhatsApp"
        id="whatsappTrigger"
      >
        <i class="fa-brands fa-whatsapp fa-bounce"></i>
      </a>

      <!-- YouTube Button (unchanged) -->
      <a
        href="https://youtube.com/@bikebuilders-vo2nm?feature=shared"
        class="floating-btn youtube-btn"
        data-tooltip="Watch on YouTube"
        aria-label="Watch on YouTube"
      >
        <i class="fa-brands fa-youtube fa-beat-fade" style="color: #ff0000"></i>
      </a>

      <!-- Call Button -->
      <a
        href="#"
        class="floating-btn call-btn"
        data-tooltip="Call Us"
        aria-label="Call Us"
        id="callTrigger"
      >
        <i class="fa-solid fa-phone-volume fa-shake"></i>
      </a>
    </div>

    <!-- WhatsApp Modal -->
    <div id="whatsappModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>Choose WhatsApp Number</h3>
        <button class="number-option" data-number="918210283582">
          +91 82102 83582
        </button>
        <button class="number-option" data-number="919876543210">
          +91 98358 44897
        </button>
      </div>
    </div>

    <!-- Call Modal -->
    <div id="callModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>Choose Number to Call</h3>
        <button class="number-option" data-number="918210283582">
          +91 82102 83582
        </button>
        <button class="number-option" data-number="919876543210">
          +91 98358 44897
        </button>
      </div>
    </div>
  </body>
</html>